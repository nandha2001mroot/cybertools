<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PE Header Viewer - CyberTools | Nandha Kumar M</title>
    <meta name="description" content="Professional PE header viewer by Nandha Kumar M. Analyze Portable Executable headers for malware analysis.">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../../styles.css" rel="stylesheet">
</head>
<body>
    <div id="header-placeholder"></div>

    <div class="container mt-4">
        <div class="tool-page">
            <h1 class="tool-title">
                <i class="fas fa-file-code me-2"></i>PE Header Viewer
            </h1>
            <p class="tool-description">
                <i class="fas fa-shield-alt me-1"></i>
                Analyze Portable Executable (PE) headers to understand Windows executable structure. Essential for malware analysis and reverse engineering.
            </p>

            <div class="card">
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">PE File Upload</label>
                        <input type="file" id="peFileUpload" class="form-control">
                    </div>
                    
                    <div class="d-flex gap-2 mb-3">
                        <button id="analyzePE" class="btn btn-primary">
                            <i class="fas fa-search me-2"></i>Analyze PE Header
                        </button>
                        <button id="clearAll" class="btn btn-secondary">
                            <i class="fas fa-eraser me-2"></i>Clear All
                        </button>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6>File Information</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-2">
                                        <strong>File Name:</strong> <span id="fileName">-</span>
                                    </div>
                                    <div class="mb-2">
                                        <strong>File Size:</strong> <span id="fileSize">-</span>
                                    </div>
                                    <div class="mb-2">
                                        <strong>Architecture:</strong> <span id="architecture">-</span>
                                    </div>
                                    <div class="mb-2">
                                        <strong>Subsystem:</strong> <span id="subsystem">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Security Analysis</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-2">
                                        <strong>Compilation Time:</strong> <span id="compilationTime">-</span>
                                    </div>
                                    <div class="mb-2">
                                        <strong>Sections:</strong> <span id="sectionsCount">-</span>
                                    </div>
                                    <div class="mb-2">
                                        <strong>Import Table:</strong> <span id="importTable">-</span>
                                    </div>
                                    <div class="mb-2">
                                        <strong>Suspicious Indicators:</strong> <span id="suspiciousIndicators">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-3">
                        <h6>DOS Header</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Field</th>
                                        <th>Offset</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody id="dosHeader">
                                    <!-- Results will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="mt-3">
                        <h6>NT Headers</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Field</th>
                                        <th>Offset</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody id="ntHeaders">
                                    <!-- Results will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="mt-3">
                        <h6>Section Headers</h6>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Virtual Size</th>
                                        <th>Virtual Address</th>
                                        <th>Raw Size</th>
                                        <th>Raw Address</th>
                                        <th>Characteristics</th>
                                    </tr>
                                </thead>
                                <tbody id="sectionHeaders">
                                    <!-- Results will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-header bg-dark">
                    <h5><i class="fas fa-info-circle me-2"></i>About PE Headers</h5>
                </div>
                <div class="card-body">
                    <p>The Portable Executable (PE) format is a file format for executables, object code, DLLs, and others used in 32-bit and 64-bit Windows operating systems.</p>
                    <h6>PE Structure:</h6>
                    <ul>
                        <li><strong>DOS Header:</strong> Legacy MS-DOS stub</li>
                        <li><strong>NT Headers:</strong> PE signature and file header</li>
                        <li><strong>Optional Header:</strong> Image information</li>
                        <li><strong>Section Headers:</strong> Describes sections</li>
                        <li><strong>Sections:</strong> Actual code and data</li>
                    </ul>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-header bg-dark">
                    <h5><i class="fas fa-lightbulb me-2"></i>Expert Insight</h5>
                </div>
                <div class="card-body">
                    <div class="insight-item">
                        <h6><i class="fas fa-bug me-2"></i>Malware Analysis</h6>
                        <p class="small text-muted">In malware analysis, PE header examination is crucial for understanding executable behavior and identifying packers or obfuscation techniques. Nandha Kumar M's research shows that analyzing PE headers helps in detecting malicious characteristics.</p>
                    </div>
                    <div class="insight-item">
                        <h6><i class="fas fa-search me-2"></i>Reverse Engineering</h6>
                        <p class="small text-muted">PE header analysis is fundamental in reverse engineering Windows executables to understand their structure and functionality.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../header-footer.js"></script>
    <script src="pe-header-viewer.js"></script>
</body>
</html>